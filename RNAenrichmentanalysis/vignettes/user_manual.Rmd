---
title: "user_manual_RNAenrichmentanalysis"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{user_manual}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

## Package and dependency installation: ##
Dependencies that need to be installed. And installation of package from github.

The package depends on openxlsx, and bioconductor packages: edgeR, clusterProfiler, enrichplot, and org.Hs.eg.db.
```{r setup}  
#Package installation 
#Install devtools if not installed 
if(!requireNamespace("devtools", quietly = TRUE))
   install.packages("devtools")
library(devtools)

#Package isntallaation from Github
library(devtools)
devtools::install_github("ekaterinalavrova7300/Seminar_assignment_git", subdir = "RNAenrichmentanalysis")
library(RNAenrichmentanalysis)

#Dependencies installation 
#Bioconductor if not already isntalled 
if(!requireNamespace("BiocManager", quietly = TRUE))
   install.packages("BiocManager")

#install edgeR 
if(!requireNamespace("edgeR", quietly = TRUE))
  BiocManager::install("edgeR")

#install openxlsx
if(!requireNamespace("openxlsx", quietly = TRUE))
   install.packages("openxlsx")

#install clusterProfiler
if(!requireNamespace("clusterProfiler", quietly = TRUE))
  BiocManager::install("clusterProfiler")

#install enrichplot
if(!requireNamespace("enrichplot", quietly = TRUE))
  BiocManager::install("enrichplot")

#install org.Hs.eg.db
if(!requireNamespace("org.Hs.eg.db", quietly = TRUE))
  BiocManager::install("org.Hs.eg.db")

```

## Example workflow ##

```{r import_and_filter}

#import data 
count_table_path = system.file("extdata","E-MTAB-2523.counts.txt",package = "RNAenrichmentanalysis")
sample_table_path = system.file("extdata","E-MTAB-2523_sample_table.txt",package = "RNAenrichmentanalysis")

#Filter count_table 
filtered_counts = import_and_filter_data(
  count_table = count_table_path, 
  min_CPM = 1,
  min_sample = 2
)

#print head of filtered count table 
head(filtered_counts)


```

```{r Differential_gene_expression }

#Create a DGE table and filter it 
filtered_DEG = DEG_analysis(
  filtered_count_table =filtered_counts,
  sample_table = sample_table_path,
  fdr_threshold = 0.05,
  logFC_threshold = 1,
  excel_file= NULL
)

#print head of filtered DEG table
head(filtered_DEG)

```

```{r Over_representation}
#take the data and do and Over representation analysis,
OR_data<- Over_representation_analysis(filtered_DEG, GO="ALL")

#print heads of OR data for KEGG and GO KEGG being for biochemical pathways, and GO for the aforementioned categories
head(OR_data$KEGG)
head(OR_data$GO)
```

```{r Plots, fig.width=6, fig.height=4}
#creating the GO data plots
GODATA<-OR_data$GO
PlotsG<- Plots(GODATA, categories=20)

#creating the KEGG data plots
KEGGDATA<- OR_data$KEGG
PlotsK<- Plots(KEGGDATA, categories=20)

#printing the GO data plots
print(PlotsG$tree)
print(PlotsG$dot)
print(PlotsG$net_plot)

#printing the KEGG data plots
print(PlotsK$tree)
print(PlotsK$dot)
print(PlotsK$net_plot)

```

## Function explanation ##
The import_and_filter_data function Imports the count_table and filters it using the CPM method from edgR. The DEG_analysis function takes these counts and and produces a DEG list which is then filtered based on log2FC and FDR. 

Over_representation takes up the DEG data filtered data and  returns as a list, GO ALL means it looks at all categories
BP for biological pathways, MF for molecular function, and CC for cellular component. KEGG on the other hand accesses all biochemical pathways

## Plots and results  ##
Plots show an over representation of genes connected to hormone synthesis in the Thyroid as well as calcium absorption in addition to bone development. These terms were also present when testing the categories in GO as there was an over representation of genes connected to gland development as well as sodium ion transport and more importantly genes connected to the development of the skeleton, kidneys and the creation of organs in general showing 
